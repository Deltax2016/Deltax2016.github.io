<!DOCTYPE html>
<html>
    <head>
        <title>energy</title>
        <meta charset='utf-8' />
    </head>
    <body>
        <canvas id="example">Ваш браузер не поддерживает Canvas</canvas>
        <script>
            var example = document.getElementById("example"),
			    ctx     = example.getContext('2d');
				window.addEventListener('keydown',this.check,false);
				window.addEventListener("mousedown", doMouseDown, false);
				example.width = 840;
				example.height = 480;
				ctx.fillStyle = "green";
				ctx.font = "15px Arial";
				var i =0;
				var char = [];
				var x1 =0;
				var y1 = 0;
				var x2 =0;
				var y2 = 0;
				var x3 =0;
				var y3 = 0;
				var wid = 2600;
				var hei = 4000;
				var globX = 0;
				var globY = 0;
				var img = new Image();
				img.src = 'original.png'; 
				img.onload = function() { 
				ctx.drawImage(img,x1,y1);
				ctx.fillRect(640, 0, 200, 480);
				}
				img.crossOrigin = "Anonymous";
				var point = new Image();
				point.src = 'point.png'; 
				point.onload = function() { 
				//ctx.drawImage(point,x2,y2);
				}
				point.crossOrigin = "Anonymous";
            function check(e) {
			var code = e.keyCode;
			switch (code) {
			case 37: if (x1 != 0) {x1+=8; x3+=8;}break; //Left key
			case 38: if (y1 != 0) {y1+=8; y3+=8} break; //Up key
			case 39: if (x1 >-wid+640) {x1-=8; x3-=8;} break; //Right key
			case 40: if (y1 >-hei+480) {y1-=8; y3-=8;}break; //Down key
			case 81: if (wid >= 640 && hei >= 480) {wid -=8; hei-=12,3; x3 -=1,8; y3 -=1,8;} break; 
			case 69: if (wid <= 2600 && hei <= 4000) {wid +=8; hei +=12,3; x3 +=1,8; y3 +=1,8;} break; 
			case 48: if (i<6) {char[i] = 0; i+=1;} break;
			case 49: if (i<6) {char[i] = 1; i+=1;} break;
			case 50: if (i<6) {char[i] = 2; i+=1; } break;
			case 51: if (i<6) {char[i] = 3; i+=1; } break;
			case 52: if (i<6) {char[i] = 4; i+=1; } break;
			case 53: if (i<6) {char[i] = 5; i+=1; } break;
			case 54: if (i<6) {char[i] = 6; i+=1; } break;
			case 55: if (i<6) {char[i] = 7; i+=1; } break;
			case 56: if (i<6) {char[i] = 8; i+=1; } break;
			case 57: if (i<6) {char[i] = 9; i+=1; } break;
			case 8: if (i>0) {i--;} break;
			
			default: alert(code); //Everything else
			}
			//ctx.clearRect(0, 0, canvas.width, canvas.height);
			globX=x2+x3;
			globY=y2+y3;
			ctx.drawImage(img,x1,y1,wid, hei);
			ctx.drawImage(point,x2+x3,y2+y3,32,32);
			ctx.fillRect(640, 0, 200, 480);
		    	ctx.fillStyle = "white";
		    	for (var j=0; j<i; j++) ctx.fillText(char[j],640+15*(j),100);
		    	ctx.fillStyle = "green";
			}
			function doMouseDown(e) {
				x2 = e.pageX -16;
				y2 = e.pageY - 30;
				//ctx.clearRect(0, 0, canvas.width, canvas.height);
				ctx.drawImage(img,x1,y1, wid, hei);
				ctx.drawImage(point,x2,y2,32,32);
				ctx.fillRect(640, 0, 200, 480);
				x3= 0;
				y3=0;
				globX=x2+x3;
				globY=y2+y3;
				var imgData = ctx.getImageData(e.pageX, e.pageY+50, 1, 1);
				red = imgData.data[0];
				green = imgData.data[1];
				blue = imgData.data[2];
				alpha = imgData.data[3];
				console.log(red + " " + green + " " + blue + " " + alpha); 
			}
                
        </script>
    </body>
</html>
